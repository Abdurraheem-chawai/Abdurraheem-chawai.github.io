<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>User Registration</title>
  <style>
    :root {
      --gap: 12px;
      --max-width: 520px;
      --accent: #2b7cff;
      --danger: #d9534f;
      --ok: #28a745;
    }
    body {
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      display: flex;
      justify-content: center;
      padding: 40px 16px;
      background: #fafafa;
    }

    .form-container {
      width: 100%;
      max-width: var(--max-width);
      background: #fff;
      padding: 20px;
      box-shadow: 0 6px 18px rgba(0,0,0,0.06);
      border-radius: 8px;
      display: flex;
      flex-direction: column;
      gap: var(--gap);
    }

    h1 { margin: 0 0 6px 0; font-size: 1.2rem; }
    .hint { color: #555; margin: 0 0 var(--gap) 0; font-size: 0.95rem; }

    form {
      display: flex;
      flex-direction: column;
      gap: var(--gap);
      align-items: stretch;
    }

    .field {
      display: flex;
      flex-direction: column;
    }

    label { font-weight: 600; margin-bottom: 6px; font-size: 0.95rem; }
    input[type="text"],
    input[type="password"],
    input[type="file"],
    input[type="date"] {
      padding: 10px;
      font-size: 1rem;
      border: 1px solid #ddd;
      border-radius: 6px;
    }

    .row { display: flex; gap: var(--gap); flex-wrap: wrap; }
    .small { flex: 1 1 48%; min-width: 140px; }

    .errors { color: var(--danger); font-size: 0.9rem; min-height: 1.25em; }
    .success { color: var(--ok); font-size: 0.95rem; }

    /* Strength bar */
    .strength {
      display: flex;
      flex-direction: column;
      gap: 6px;
    }
    .bar {
      height: 10px;
      background: #eee;
      border-radius: 6px;
      overflow: hidden;
    }
    .bar-inner {
      height: 100%;
      width: 0%;
      transition: width 200ms ease, background-color 200ms ease;
    }
    .strength-label { font-size: 0.9rem; font-weight: 600; }

    button {
      padding: 10px 14px;
      font-size: 1rem;
      border: none;
      background: var(--accent);
      color: #fff;
      border-radius: 6px;
      cursor: pointer;
    }
    button:disabled { opacity: 0.6; cursor: not-allowed; }
    .meta { font-size: 0.9rem; color: #555; }
  </style>
</head>
<body>
  <main class="form-container" aria-labelledby="title">
    <h1 id="title">User Registration</h1>
    <p class="hint">Complete the form. Username must be 5–15 chars. Password must include letters and numbers. Profile picture must be JPG or PNG.</p>

    <form id="regForm" novalidate>
      <div class="field">
        <label for="username">Username</label>
        <input id="username" name="username" type="text" required minlength="5" maxlength="15" placeholder="Enter username">
        <div id="usernameErr" class="errors" aria-live="polite"></div>
      </div>

      <div class="field">
        <label for="password">Password</label>
        <input id="password" name="password" type="password" required placeholder="Enter password">
        <div class="strength" aria-live="polite">
          <div class="bar" aria-hidden="true">
            <div id="barInner" class="bar-inner"></div>
          </div>
          <div class="row" style="align-items:center; justify-content:space-between;">
            <div id="strengthLabel" class="strength-label">Strength: —</div>
            <div id="passwordErr" class="errors" style="text-align:right;"></div>
          </div>
        </div>
      </div>

      <div class="field">
        <label for="avatar">Profile Picture</label>
        <input id="avatar" name="avatar" type="file" accept="image/png,image/jpeg" required>
        <div id="avatarErr" class="errors" aria-live="polite"></div>
      </div>

      <div style="display:flex; gap:12px; align-items:center;">
        <button id="submitBtn" type="submit">Register</button>
        <div id="status" class="meta" aria-live="polite"></div>
      </div>
    </form>
  </main>

  <script>
    // Elements
    const form = document.getElementById('regForm');
    const username = document.getElementById('username');
    const password = document.getElementById('password');
    const avatar = document.getElementById('avatar');

    const usernameErr = document.getElementById('usernameErr');
    const passwordErr = document.getElementById('passwordErr');
    const avatarErr = document.getElementById('avatarErr');
    const barInner = document.getElementById('barInner');
    const strengthLabel = document.getElementById('strengthLabel');
    const status = document.getElementById('status');
    const submitBtn = document.getElementById('submitBtn');

    // Password strength evaluator
    function evaluatePassword(pw) {
      let score = 0;
      if (!pw) return {label: '—', pct: 0, color: '#eee'};
      if (pw.length >= 8) score += 1;
      if (pw.length >= 12) score += 1;
      if (/[A-Z]/.test(pw)) score += 1;
      if (/[0-9]/.test(pw)) score += 1;
      if (/[^A-Za-z0-9]/.test(pw)) score += 1;

      // Map score to label & percent
      if (score <= 1) return {label: 'Weak', pct: 25, color: '#e55353'};
      if (score <= 3) return {label: 'Medium', pct: 60, color: '#f0ad4e'};
      return {label: 'Strong', pct: 100, color: '#28a745'};
    }

    // Live updates for password
    password.addEventListener('input', () => {
      const pw = password.value;
      const res = evaluatePassword(pw);
      barInner.style.width = res.pct + '%';
      barInner.style.backgroundColor = res.color;
      strengthLabel.textContent = `Strength: ${res.label}`;
      passwordErr.textContent = ''; // clear inline password error while typing
    });

    // Username validation on blur/input
    function validateUsername() {
      const val = username.value.trim();
      if (val.length < 5 || val.length > 15) {
        usernameErr.textContent = 'Username must be 5–15 characters.';
        return false;
      }
      usernameErr.textContent = '';
      return true;
    }
    username.addEventListener('blur', validateUsername);
    username.addEventListener('input', () => { if (usernameErr.textContent) validateUsername(); });

    // Avatar validation
    function validateAvatar() {
      avatarErr.textContent = '';
      const file = avatar.files[0];
      if (!file) {
        avatarErr.textContent = 'Profile picture is required.';
        return false;
      }
      const okTypes = ['image/jpeg', 'image/png'];
      if (!okTypes.includes(file.type)) {
        avatarErr.textContent = 'Only JPG or PNG images are allowed.';
        return false;
      }
      return true;
    }
    avatar.addEventListener('change', validateAvatar);

    // Overall validation
    function validateForm() {
      let valid = true;
      // username
      if (!validateUsername()) valid = false;

      // password: must contain letters and numbers
      const pw = password.value;
      if (!pw || !(/[A-Za-z]/.test(pw) && /[0-9]/.test(pw))) {
        passwordErr.textContent = 'Password must contain both letters and numbers.';
        valid = false;
      } else {
        passwordErr.textContent = '';
      }

      // avatar
      if (!validateAvatar()) valid = false;

      return valid;
    }

    // Submit handler
    form.addEventListener('submit', (e) => {
      e.preventDefault();
      status.textContent = '';
      if (!validateForm()) {
        status.textContent = '';
        return;
      }

      // Simulate successful submission (in real app, send to server)
      submitBtn.disabled = true;
      status.textContent = 'Registering...';
      setTimeout(() => {
        submitBtn.disabled = false;
        status.textContent = '';
        form.reset();
        barInner.style.width = '0%';
        barInner.style.backgroundColor = '#eee';
        strengthLabel.textContent = 'Strength: —';
        alert('Registration successful (client-side demo).');
      }, 900);
    });
  </script>
</body>
</html>

